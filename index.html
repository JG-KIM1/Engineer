<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ì´íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ë¡œê·¸ì¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            font-size: 28px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.9);
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
        }

        .demo-accounts {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
            font-size: 14px;
            color: #6c757d;
            border-left: 4px solid #667eea;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: #333;
            padding: 15px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 10px;
        }

        .nav-link {
            background: none;
            border: none;
            color: #333;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover, .nav-link.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            color: #667eea;
        }

        /* ë©”ì¸ ì»¨í…ì¸  ìŠ¤íƒ€ì¼ */
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            margin: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            min-height: calc(100vh - 120px);
        }

        .page-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 30px;
            color: #333;
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        /* ëŒ€ì‹œë³´ë“œ ìŠ¤íƒ€ì¼ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-title {
            font-size: 16px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
        }

        /* í¼ ìŠ¤íƒ€ì¼ */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .time-display {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
            border-left: 4px solid #667eea;
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            margin: 0 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.1);
        }

        .action-btn.delete:hover {
            background: rgba(220, 53, 69, 0.1);
        }

        .empty-state {
            text-align: center;
            padding: 60px;
            color: #6c757d;
            font-size: 18px;
        }

        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        /* í•„í„°ë§ ìŠ¤íƒ€ì¼ */
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            align-items: end;
        }

        /* ì°¨íŠ¸ íƒ­ ìŠ¤íƒ€ì¼ */
        .chart-tabs, .stats-tabs, .register-tabs {
            display: flex;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px 10px 0 0;
            margin: -25px -25px 20px -25px;
            padding: 0;
            overflow-x: auto;
        }

        .chart-tab, .stats-tab, .register-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: 140px;
        }

        .chart-tab.active, .stats-tab.active, .register-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
            transform: translateY(-2px);
        }

        .chart-tab:hover:not(.active), .stats-tab:hover:not(.active), .register-tab:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        /* ì§€ì› íƒ€ì… ë°°ì§€ */
        .support-type-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            display: inline-block;
        }

        .support-type-badge.ì •ê¸°ì ê²€ {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .support-type-badge.ê¸°ìˆ ì§€ì› {
            background: linear-gradient(135deg, #007bff, #6610f2);
            color: white;
        }

        .support-type-badge.ì¥ì• ì§€ì› {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
        }

        /* ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ */
        .data-management-section {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 2px solid #2196f3;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }

        .data-management-title {
            font-size: 20px;
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .data-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .data-btn.save {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .data-btn.load {
            background: linear-gradient(135deg, #007bff, #6610f2);
            color: white;
        }

        .data-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .data-status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .data-status.success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }

        .data-status.error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .data-status.info {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            color: #0c5460;
            border: 2px solid #17a2b8;
        }

        /* ì—…ë¡œë“œ ìŠ¤íƒ€ì¼ */
        .upload-section {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9ff, #e6f3ff);
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #5a67d8;
            background: linear-gradient(135deg, #f0f4ff, #dbeafe);
            transform: translateY(-2px);
        }

        .upload-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-tabs, .stats-tabs, .register-tabs {
                flex-direction: column;
            }
            
            .chart-tab, .stats-tab, .register-tab {
                border-radius: 0;
                border-bottom: 1px solid #dee2e6;
            }

            .navbar-content {
                flex-direction: column;
                gap: 15px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .data-buttons {
                flex-direction: column;
            }
        }

        /* ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ */
        .hidden {
            display: none !important;
        }

        .flex {
            display: flex;
        }

        .gap-10 {
            gap: 10px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div id="loginPage" class="login-container">
        <div class="login-form">
            <h2>ğŸ¢ ì‹œì˜¤ë© ë°±ì—…ì‚¬ì´íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ </h2>
            <div class="form-group">
                <label for="username">ğŸ‘¤ ì‚¬ìš©ìëª…</label>
                <input type="text" id="username" placeholder="ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label for="password">ğŸ”’ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div id="loginError" class="error hidden"></div>
            <button class="btn" onclick="handleLogin()">ë¡œê·¸ì¸</button>
            
            <div class="demo-accounts">
                <strong>ğŸ”‘ í…ŒìŠ¤íŠ¸ ê³„ì •</strong><br>
                â€¢ admin / admin123 (ê´€ë¦¬ì)<br>
                â€¢ engineer1 / eng123 (ì—”ì§€ë‹ˆì–´)
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <div id="mainApp" class="hidden">
        <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="navbar">
            <div class="navbar-content">
                <div class="nav-links">
                    <button class="nav-link active" onclick="showPage('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
                    <button class="nav-link" onclick="showPage('register')">â• ì§€ì› ë“±ë¡</button>
                    <button class="nav-link" onclick="showPage('list')">ğŸ“‹ ì§€ì› ëª©ë¡</button>
                </div>
                <div class="user-info">
                    <span id="userWelcome">í™˜ì˜í•©ë‹ˆë‹¤</span>
                    <button class="nav-link" onclick="handleLogout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </div>
        </nav>

        <div class="main-content">
            <!-- JSON ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ -->
            <div class="container">
                <div class="data-management-section">
                    <div class="data-management-title">
                        ğŸ’¾ ë°ì´í„° ë°±ì—… ë° ë³µì›
                    </div>
                    <div class="data-buttons">
                        <button class="data-btn save" onclick="saveDataToJSON()">
                            ğŸ’¾ ë°ì´í„° ì €ì¥ (JSON)
                        </button>
                        <button class="data-btn load" onclick="document.getElementById('jsonFileInput').click()">
                            ğŸ“ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (JSON)
                        </button>
                        <input type="file" id="jsonFileInput" class="file-input" accept=".json" onchange="loadDataFromJSON(event)">
                    </div>
                    <div id="dataStatus" class="data-status hidden"></div>
                </div>
            </div>

            <!-- ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ -->
            <div id="dashboardPage" class="container">
                <h1 class="page-title">ğŸ“Š ì‹œì˜¤ë© ë°±ì—…ì‚¬ì´íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ </h1>
                
                <!-- í•„í„°ë§ ë° ê²€ìƒ‰ ì„¹ì…˜ -->
                <div class="card mb-20">
                    <div class="card-title">ğŸ” ê²€ìƒ‰ ë° í•„í„°ë§</div>
                    <div class="filter-grid">
                        <div class="form-group">
                            <label for="searchKeyword">ğŸ” í‚¤ì›Œë“œ ê²€ìƒ‰</label>
                            <input type="text" id="searchKeyword" placeholder="ì‚¬ì´íŠ¸ëª…, ì—”ì§€ë‹ˆì–´ëª… ê²€ìƒ‰" onchange="applyFilters()">
                        </div>
                        <div class="form-group">
                            <label for="filterEngineer">ğŸ‘¨â€ğŸ’» ì—”ì§€ë‹ˆì–´ í•„í„°</label>
                            <select id="filterEngineer" onchange="applyFilters()">
                                <option value="">ì „ì²´ ì—”ì§€ë‹ˆì–´</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filterSite">ğŸ¢ ì‚¬ì´íŠ¸ í•„í„°</label>
                            <select id="filterSite" onchange="applyFilters()">
                                <option value="">ì „ì²´ ì‚¬ì´íŠ¸</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filterSupportType">ğŸ› ï¸ ì§€ì› íƒ€ì… í•„í„°</label>
                            <select id="filterSupportType" onchange="applyFilters()">
                                <option value="">ì „ì²´ íƒ€ì…</option>
                                <option value="ì •ê¸°ì ê²€">ì •ê¸°ì ê²€</option>
                                <option value="ê¸°ìˆ ì§€ì›">ê¸°ìˆ ì§€ì›</option>
                                <option value="ì¥ì• ì§€ì›">ì¥ì• ì§€ì›</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filterStartDate">ğŸ“… ì‹œì‘ ë‚ ì§œ</label>
                            <input type="date" id="filterStartDate" onchange="applyFilters()">
                        </div>
                        <div class="form-group">
                            <label for="filterEndDate">ğŸ“… ì¢…ë£Œ ë‚ ì§œ</label>
                            <input type="date" id="filterEndDate" onchange="applyFilters()">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" onclick="clearFilters()">ğŸ”„ í•„í„° ì´ˆê¸°í™”</button>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">ğŸ“‹ ì´ ì§€ì› ê±´ìˆ˜</div>
                        <div class="stat-value" id="totalRecords">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">â° ì´ ì§€ì› ì‹œê°„</div>
                        <div class="stat-value" id="totalHours">0h</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ğŸ“Š í‰ê·  ì§€ì› ì‹œê°„</div>
                        <div class="stat-value" id="avgHours">0h</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ğŸ‘¥ í™œì„± ì—”ì§€ë‹ˆì–´ ìˆ˜</div>
                        <div class="stat-value" id="activeEngineers">0</div>
                    </div>
                </div>

                <!-- ì°¨íŠ¸ íƒ­ ì‹œìŠ¤í…œ -->
                <div class="card">
                    <div class="chart-tabs">
                        <button class="chart-tab active" onclick="showChartTab('monthly')">ğŸ“… ì›”ê°„ í†µê³„</button>
                        <button class="chart-tab" onclick="showChartTab('engineer')">ğŸ‘¨â€ğŸ’» ì—”ì§€ë‹ˆì–´ë³„</button>
                        <button class="chart-tab" onclick="showChartTab('supporttype')">ğŸ› ï¸ ì§€ì› íƒ€ì…ë³„</button>
                        <button class="chart-tab" onclick="showChartTab('site')">ğŸ¢ ì‚¬ì´íŠ¸ë³„</button>
                    </div>
                    
                    <div id="monthlyChartContainer" class="chart-tab-content">
                        <div class="card-title">ğŸ“… ì›”ê°„ ì‚¬ì´íŠ¸ë³„ ì§€ì› ì‹œê°„ í†µê³„</div>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                    
                    <div id="engineerChartContainer" class="chart-tab-content hidden">
                        <div class="card-title">ğŸ‘¨â€ğŸ’» ì—”ì§€ë‹ˆì–´ë³„ ì§€ì› í†µê³„</div>
                        <div class="chart-container">
                            <canvas id="engineerChart"></canvas>
                        </div>
                    </div>
                    
                    <div id="supporttypeChartContainer" class="chart-tab-content hidden">
                        <div class="card-title">ğŸ› ï¸ ì§€ì› íƒ€ì…ë³„ ë¶„ì„</div>
                        <div class="chart-container">
                            <canvas id="supportTypeChart"></canvas>
                        </div>
                    </div>
                    
                    <div id="siteChartContainer" class="chart-tab-content hidden">
                        <div class="card-title">ğŸ¢ ì‚¬ì´íŠ¸ë³„ ì´ ì§€ì› ì‹œê°„ ë¶„í¬</div>
                        <div class="chart-container">
                            <canvas id="siteChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- ìƒì„¸ í†µê³„ í˜„í™© -->
                <div class="card">
                    <div class="stats-tabs">
                        <button class="stats-tab active" onclick="showStatsTab('engineer')">ğŸ‘¨â€ğŸ’» ì—”ì§€ë‹ˆì–´ë³„ í†µê³„</button>
                        <button class="stats-tab" onclick="showStatsTab('site')">ğŸ¢ ì‚¬ì´íŠ¸ë³„ í†µê³„</button>
                        <button class="stats-tab" onclick="showStatsTab('supporttype')">ğŸ› ï¸ ì§€ì› íƒ€ì…ë³„ í†µê³„</button>
                    </div>
                    
                    <!-- ì—”ì§€ë‹ˆì–´ë³„ í†µê³„ íƒ­ -->
                    <div id="engineerStatsContainer" class="stats-tab-content">
                        <div class="card-title">ğŸ‘¨â€ğŸ’» ì—”ì§€ë‹ˆì–´ë³„ ìƒì„¸ í†µê³„</div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ì—”ì§€ë‹ˆì–´ëª…</th>
                                        <th>ì§€ì› ê±´ìˆ˜</th>
                                        <th>ì´ ì‹œê°„</th>
                                        <th>í‰ê·  ì‹œê°„</th>
                                        <th>ì •ê¸°ì ê²€</th>
                                        <th>ê¸°ìˆ ì§€ì›</th>
                                        <th>ì¥ì• ì§€ì›</th>
                                    </tr>
                                </thead>
                                <tbody id="engineerStatsBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- ì‚¬ì´íŠ¸ë³„ í†µê³„ íƒ­ -->
                    <div id="siteStatsContainer" class="stats-tab-content hidden">
                        <div class="card-title">ğŸ¢ ì‚¬ì´íŠ¸ë³„ ìƒì„¸ í†µê³„</div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ì‚¬ì´íŠ¸ëª…</th>
                                        <th>ì§€ì› ê±´ìˆ˜</th>
                                        <th>ì´ ì‹œê°„</th>
                                        <th>í‰ê·  ì‹œê°„</th>
                                        <th>ì°¸ì—¬ ì—”ì§€ë‹ˆì–´</th>
                                        <th>ì£¼ìš” ì§€ì› íƒ€ì…</th>
                                    </tr>
                                </thead>
                                <tbody id="siteStatsBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ì§€ì› íƒ€ì…ë³„ í†µê³„ íƒ­ -->
                    <div id="supporttypeStatsContainer" class="stats-tab-content hidden">
                        <div class="card-title">ğŸ› ï¸ ì§€ì› íƒ€ì…ë³„ ìƒì„¸ í†µê³„</div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ì§€ì› íƒ€ì…</th>
                                        <th>ì§€ì› ê±´ìˆ˜</th>
                                        <th>ì´ ì‹œê°„</th>
                                        <th>í‰ê·  ì‹œê°„</th>
                                        <th>ì°¸ì—¬ ì—”ì§€ë‹ˆì–´</th>
                                        <th>ë¹„ìœ¨</th>
                                    </tr>
                                </thead>
                                <tbody id="supportTypeStatsBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì§€ì› ë“±ë¡ í˜ì´ì§€ -->
            <div id="registerPage" class="container hidden">
                <h1 class="page-title" id="registerTitle">â• ì‚¬ì´íŠ¸ ì§€ì› ë“±ë¡</h1>
                
                <div class="card">
                    <!-- ë“±ë¡ ë°©ë²• íƒ­ -->
                    <div class="register-tabs">
                        <button class="register-tab active" onclick="showRegisterTab('manual')">ğŸ“ ìˆ˜ë™ ë“±ë¡</button>
                        <button class="register-tab" onclick="showRegisterTab('excel')">ğŸ“„ ì—‘ì…€ ì—…ë¡œë“œ</button>
                    </div>

                    <!-- ìˆ˜ë™ ë“±ë¡ íƒ­ -->
                    <div id="manualRegisterContent" class="register-tab-content">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="siteName">ğŸ¢ ì§€ì› ì‚¬ì´íŠ¸ëª…</label>
                                <input type="text" id="siteName" placeholder="ì‚¬ì´íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                            <div class="form-group">
                                <label for="engineerName">ğŸ‘¨â€ğŸ’» ì§€ì› ì—”ì§€ë‹ˆì–´ ì´ë¦„</label>
                                <input type="text" id="engineerName" placeholder="ì—”ì§€ë‹ˆì–´ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                            <div class="form-group">
                                <label for="supportType">ğŸ› ï¸ ì§€ì› íƒ€ì…</label>
                                <select id="supportType">
                                    <option value="">ì§€ì› íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="ì •ê¸°ì ê²€">ì •ê¸°ì ê²€</option>
                                    <option value="ê¸°ìˆ ì§€ì›">ê¸°ìˆ ì§€ì›</option>
                                    <option value="ì¥ì• ì§€ì›">ì¥ì• ì§€ì›</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="startDate">ğŸ“… ì§€ì› ì‹œì‘ ë‚ ì§œ</label>
                                <input type="date" id="startDate">
                            </div>
                            <div class="form-group">
                                <label for="startTime">ğŸ• ì§€ì› ì‹œì‘ ì‹œê°„</label>
                                <input type="time" id="startTime">
                            </div>
                            <div class="form-group">
                                <label for="endDate">ğŸ“… ì§€ì› ì¢…ë£Œ ë‚ ì§œ</label>
                                <input type="date" id="endDate">
                            </div>
                            <div class="form-group">
                                <label for="endTime">ğŸ• ì§€ì› ì¢…ë£Œ ì‹œê°„</label>
                                <input type="time" id="endTime">
                            </div>
                        </div>

                        <div class="time-display">
                            <strong>â±ï¸ ì „ì²´ ì§€ì› ì‹œê°„: </strong><span id="calculatedHours">0</span> ì‹œê°„
                        </div>

                        <div class="flex gap-10">
                            <button class="btn" onclick="handleSubmitSupport()" id="submitBtn">ë“±ë¡</button>
                            <button class="btn btn-secondary hidden" onclick="handleCancelEdit()" id="cancelBtn">ì·¨ì†Œ</button>
                        </div>
                    </div>

                    <!-- ì—‘ì…€ ì—…ë¡œë“œ íƒ­ -->
                    <div id="excelRegisterContent" class="register-tab-content hidden">
                        <!-- í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ -->
                        <div class="mb-20">
                            <h3>ğŸ“‹ ì—‘ì…€ í…œí”Œë¦¿</h3>
                            <p>ì•„ë˜ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ë°ì´í„°ë¥¼ ì…ë ¥í•œ í›„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.</p>
                            <button class="upload-btn" onclick="downloadExcelTemplate()">
                                ğŸ“¥ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>

                        <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
                        <div class="upload-section" id="uploadSection">
                            <div>
                                <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“„</div>
                                <h3>ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</h3>
                                <p>íŒŒì¼ì„ ëŒì–´ì„œ ë†“ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</p>
                                <input type="file" id="excelFileInput" class="file-input" accept=".xlsx,.xls" onchange="handleFileUpload(event)">
                                <button class="upload-btn" onclick="document.getElementById('excelFileInput').click()">
                                    ğŸ“ íŒŒì¼ ì„ íƒ
                                </button>
                                <div style="margin-top: 15px; color: #6c757d; font-size: 14px;">
                                    ì§€ì› í˜•ì‹: Excel (.xlsx, .xls) | ìµœëŒ€ í¬ê¸°: 10MB
                                </div>
                            </div>
                        </div>

                        <div id="previewSection" class="hidden">
                            <h3>ğŸ“Š ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°</h3>
                            <div id="previewTable"></div>
                            
                            <div class="flex gap-10" style="margin-top: 20px;">
                                <button class="btn" onclick="processExcelData()">
                                    âœ… ë°ì´í„° ë“±ë¡
                                </button>
                                <button class="btn btn-secondary" onclick="clearExcelData()">
                                    ğŸ”„ ë‹¤ì‹œ ì—…ë¡œë“œ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì§€ì› ëª©ë¡ í˜ì´ì§€ -->
            <div id="listPage" class="container hidden">
                <h1 class="page-title">ğŸ“‹ ì§€ì› ê¸°ë¡ ëª©ë¡</h1>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ì‚¬ì´íŠ¸ëª…</th>
                                <th>ì—”ì§€ë‹ˆì–´</th>
                                <th>ì§€ì› íƒ€ì…</th>
                                <th>ì‹œì‘ì¼ì‹œ</th>
                                <th>ì¢…ë£Œì¼ì‹œ</th>
                                <th>ì´ ì‹œê°„</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="recordsTableBody">
                        </tbody>
                    </table>
                    <div id="emptyState" class="empty-state hidden">
                        ğŸ—‚ï¸ ë“±ë¡ëœ ì§€ì› ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
        'use strict';
        
        // ì „ì—­ ë³€ìˆ˜
        let currentUser = null;
        let currentPage = 'dashboard';
        let supportRecords = [];
        let filteredRecords = [];
        let editingRecord = null;
        let charts = {};
        let currentChartTab = 'monthly';
        let currentStatsTab = 'engineer';
        let currentRegisterTab = 'manual';

        // ğŸ’¡ [í•„ìˆ˜ ìˆ˜ì •] GitHubì— ì—…ë¡œë“œëœ CSV íŒŒì¼ì˜ Raw URLì„ ì—¬ê¸°ì— ì§€ì •í•˜ì„¸ìš”.
        // ì˜ˆ: 'https://raw.githubusercontent.com/JG-KIM1/Engineer/main/calender.CSV'
        const GITHUB_CSV_URL = 'https://raw.githubusercontent.com/JG-KIM1/Engineer/main/calender.CSV'; 

        // ì‚¬ìš©ì ë°ì´í„°
        const users = [
            { username: 'admin', password: 'admin123', name: 'ê´€ë¦¬ì' },
            { username: 'engineer1', password: 'eng123', name: 'ì—”ì§€ë‹ˆì–´1' }
        ];

        // **[ìˆ˜ì •ëœ í•¨ìˆ˜]** ì§€ì› íƒ€ì… ìë™ ë¶„ë¥˜ ë¡œì§
        function classifySupportType(title, description) {
            const text = (title || '') + ' ' + (description || '');
            const lowerText = text.toLowerCase();
            
            // í‚¤ì›Œë“œ ëª©ë¡
            const keywords = {
                'ì •ê¸°ì ê²€': ['ì •ê¸° ì ê²€', 'ì •ê¸°', 'ì •ê¸°ì ê²€', 'ì ê²€'],
                'ì¥ì• ì§€ì›': ['ì¥ì• ', 'ì¥ì• ì§€ì›', 'ì¥ì•  ì§€ì›', 'ì´ìŠˆ ë°©ë¬¸', 'fault', 'down', 'ì‹¤íŒ¨'],
                'ê¸°ìˆ ì§€ì›': [
                    'ê¸°ìˆ ì§€ì›', 'ê¸°ìˆ ë¯¸íŒ…', 'ê¸°ìˆ  ì§€ì›', 'ê¸°ìˆ  ë¯¸íŒ…', 'ì›ê²©ì§€ì›', 'ì›ê²© ì§€ì›', 
                    'ì‹¤ì‚¬', 'ê°œë°œ ë¯¸íŒ…', 'ê°œë°œë¯¸íŒ…', 'ë‹´ë‹¹ì êµìœ¡', 'ì´ìŠˆ ì§€ì›', 'ì‘ì—…', 
                    'ìš´ì˜ì êµìœ¡', 'ë°±ì—… êµ¬ì„±', 'ì •ì±… êµ¬ì„±', 'ë°±ì—… êµ¬ì¶•', 'ë°±ì—…êµ¬ì¶•', 'ë¶„ì„',
                    'ì„¤ì¹˜', 'êµ¬ì„±', 'í…ŒìŠ¤íŠ¸', 'review', 'poc' 
                ]
            };

            // 3. ì •ê¸°ì ê²€ ìš°ì„  í™•ì¸
            if (keywords.ì •ê¸°ì ê²€.some(k => lowerText.includes(k))) {
                return 'ì •ê¸°ì ê²€';
            }

            // 2. ì¥ì• ì§€ì› í™•ì¸
            if (keywords.ì¥ì• ì§€ì›.some(k => lowerText.includes(k))) {
                return 'ì¥ì• ì§€ì›';
            }
            
            // 1. ê¸°ìˆ ì§€ì› í™•ì¸
            if (keywords.ê¸°ìˆ ì§€ì›.some(k => lowerText.includes(k))) {
                return 'ê¸°ìˆ ì§€ì›';
            }
            
            // í‚¤ì›Œë“œì— í•´ë‹¹í•˜ì§€ ì•Šìœ¼ë©´ null ë°˜í™˜ (parseOutlookCsvDataì—ì„œ ê¸°íƒ€/ì œì™¸ ì²˜ë¦¬)
            return null; 
        }

        // **[ìƒˆë¡œìš´ ê¸°ëŠ¥]** íŠ¹ì • í‚¤ì›Œë“œê°€ í¬í•¨ëœ í•­ëª©ì„ í•„í„°ë§í•˜ëŠ” í•¨ìˆ˜ (ì œì™¸ ë¡œì§ ê°•í™”)
        function isExcluded(title, description) {
            const lowerTitle = (title || '').toLowerCase();
            const lowerDesc = (description || '').toLowerCase();
            
            // 1. ë‚´ë¶€ ì‚¬ë¬´ì‹¤ ê´€ë ¨ í‚¤ì›Œë“œ í™•ì¸ (4. ê¸°íƒ€ì§€ì› ì œì™¸ ê¸°ì¤€)
            const internalKeywords = ['ì‚¬ë¬´ì‹¤', 'í•˜ë‚¨ ì‚¬ë¬´ì‹¤', 'í•˜ë‚¨ì‚¬ë¬´ì‹¤', 'ì‹œì˜¤ë©', 'ì‚¬ë‚´'];
            if (internalKeywords.some(k => lowerTitle.includes(k))) {
                return true; // ì‚¬ë¬´ì‹¤ ê´€ë ¨ ì¼ì •ì€ ì œì™¸
            }

            // 2. ëª…ì‹œì ìœ¼ë¡œ ì œì™¸í•  í‚¤ì›Œë“œ (ì œëª©/ì„¤ëª… ë¬´ê´€)
            const permanentExcludeKeywords = ['ì·¨ì†Œë¨', 'ì˜ˆë¹„êµ°', 'ë¯¼ë°©ìœ„', 'ì›”ì„¸', 'ê³µê°€', 'ì—°ì°¨', 'ì›Œí¬ìƒµ', 'íšŒì‹'];
            if (permanentExcludeKeywords.some(k => lowerTitle.includes(k) || lowerDesc.includes(k))) {
                return true;
            }
            
            return false;
        }

        // **[ì¶”ê°€ëœ í•¨ìˆ˜]** ë¡œê·¸ì¸ ìƒíƒœë¥¼ localStorageì— ì €ì¥í•˜ê³  UI ì—…ë°ì´íŠ¸
        function setLoginState(user) {
            currentUser = user;
            if (user) {
                // ì‚¬ìš©ì ê°ì²´ë¥¼ JSON ë¬¸ìì—´ë¡œ ì €ì¥
                localStorage.setItem('currentUser', JSON.stringify(user));
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                document.getElementById('userWelcome').textContent = `${user.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
                showPage('dashboard');
            } else {
                // ì €ì¥ëœ ì‚¬ìš©ì ì •ë³´ ì œê±°
                localStorage.removeItem('currentUser');
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginPage').classList.remove('hidden');
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            }
        }
        
        // **[ìˆ˜ì •ëœ í•¨ìˆ˜]** ë¡œê·¸ì¸ ì²˜ë¦¬
        function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');

            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                errorElement.classList.add('hidden');
                // ë¡œê·¸ì¸ ìƒíƒœ ì„¤ì • ë° ì €ì¥
                setLoginState(user); 
            } else {
                errorElement.textContent = 'ì˜ëª»ëœ ì‚¬ìš©ìëª… ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.';
                errorElement.classList.remove('hidden');
            }
        }

        // **[ìˆ˜ì •ëœ í•¨ìˆ˜]** ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
        function handleLogout() {
            // ë¡œê·¸ì¸ ìƒíƒœ ì´ˆê¸°í™” ë° ì œê±°
            setLoginState(null); 
            showPage('dashboard');
        }

        // í˜ì´ì§€ ì „í™˜ (ìƒëµëœ ë¶€ë¶„ì€ ìœ„ì™€ ë™ì¼)
        function showPage(page) {
            ['dashboardPage', 'registerPage', 'listPage'].forEach(p => {
                document.getElementById(p).classList.add('hidden');
            });

            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // event.targetì´ ì—†ëŠ” ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ ì²˜ë¦¬ (ì˜ˆ: ìë™ ë¡œê·¸ì¸ ì‹œ)
            const targetElement = event && event.target ? event.target : document.querySelector(`.nav-links .nav-link[onclick*="${page}"]`);
            if (targetElement) {
                targetElement.classList.add('active');
            } else {
                 // ê¸°ë³¸ì ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œ ë§í¬ë¥¼ í™œì„±í™”
                document.querySelector('.nav-links .nav-link').classList.add('active');
            }

            document.getElementById(page + 'Page').classList.remove('hidden');
            
            currentPage = page;

            if (page === 'dashboard') {
                updateFilterOptions();
                applyFilters();
            } else if (page === 'list') {
                updateRecordsList();
            }
        }

        // ... (ì´í•˜ ëª¨ë“  í•¨ìˆ˜ëŠ” ë³€ê²½ ì—†ìŒ)
        
        // í˜„ì¬ ê¸°ë¡ì„ ë¡œì»¬ ì €ì¥ì†Œì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
        function saveRecordsToLocalStorage() {
            try {
                localStorage.setItem('supportRecords', JSON.stringify(supportRecords));
            } catch (e) {
                console.error("ë¡œì»¬ ì €ì¥ì†Œì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", e);
                // alert("ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì €ì¥ ê³µê°„ì´ ê°€ë“ ì°¼ê±°ë‚˜ ê°œì¸ ì •ë³´ ë³´í˜¸ ì„¤ì • ë•Œë¬¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
        }
        
        // ì§€ì› ê¸°ë¡ ì œì¶œ (saveRecordsToLocalStorage í˜¸ì¶œ)
        function handleSubmitSupport() {
            const siteName = document.getElementById('siteName').value;
            const engineerName = document.getElementById('engineerName').value;
            const supportType = document.getElementById('supportType').value;
            const startDate = document.getElementById('startDate').value;
            const startTime = document.getElementById('startTime').value;
            const endDate = document.getElementById('endDate').value;
            const endTime = document.getElementById('endTime').value;

            if (!siteName || !engineerName || !supportType || !startDate || !startTime || !endDate || !endTime) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const totalHours = calculateSupportHours(startDate, startTime, endDate, endTime);

            const record = {
                id: editingRecord ? editingRecord.id : Date.now(),
                siteName,
                engineerName,
                supportType,
                startDate,
                startTime,
                endDate,
                endTime,
                totalHours: totalHours.toFixed(1),
                createdAt: editingRecord ? editingRecord.createdAt : new Date().toISOString()
            };

            if (editingRecord) {
                const index = supportRecords.findIndex(r => r.id === record.id);
                supportRecords[index] = record;
            } else {
                supportRecords.push(record);
            }

            // ë³€ê²½ëœ ë°ì´í„°ë¥¼ ë¡œì»¬ ì €ì¥ì†Œì— ë°˜ì˜
            saveRecordsToLocalStorage(); 

            clearForm();
            alert(editingRecord ? 'ê¸°ë¡ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ê¸°ë¡ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
            showPage('list');
        }

        // ... (ë‚˜ë¨¸ì§€ í•¨ìˆ˜ ìƒëµ - `deleteRecord`, `processExcelData` ë“±ë„ `saveRecordsToLocalStorage`ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ë˜ì–´ìˆìŠµë‹ˆë‹¤.)
        
        // ë¡œì»¬ ì €ì¥ì†Œì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
        function loadRecordsFromLocalStorage() {
            const savedData = localStorage.getItem('supportRecords');
            if (savedData) {
                try {
                    supportRecords = JSON.parse(savedData);
                    supportRecords.forEach(r => {
                        r.totalHours = parseFloat(r.totalHours);
                        r.id = parseInt(r.id); 
                    });
                    filteredRecords = supportRecords.slice();
                    console.log(`âœ… ${supportRecords.length}ê°œì˜ ê¸°ë¡ì„ ë¡œì»¬ ì €ì¥ì†Œì—ì„œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
                    return true;
                } catch (e) {
                    console.error("ë¡œì»¬ ì €ì¥ì†Œ ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", e);
                    localStorage.removeItem('supportRecords'); 
                    return false;
                }
            }
            return false;
        }

        // GitHub CSV ìë™ ë¡œë“œ í•¨ìˆ˜ (ìƒëµëœ ë¶€ë¶„ì€ ìœ„ì™€ ë™ì¼)
        function loadRecordsFromGitHub() {
            if (GITHUB_CSV_URL.includes('YOUR_GITHUB_RAW_CSV_URL_HERE')) {
                console.warn("GitHub CSV URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.");
                generateSampleData();
                return;
            }
            
            fetch(GITHUB_CSV_URL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP Error! Status: ${response.status}. CSV ë¡œë“œ ì‹¤íŒ¨.`);
                    }
                    return response.text(); 
                })
                .then(csvText => {
                    const parsedData = parseOutlookCsvData(csvText);

                    if (parsedData.length > 0) {
                        supportRecords = parsedData.map(record => ({
                            id: Date.now() + Math.random(),
                            ...record,
                            createdAt: new Date().toISOString()
                        }));

                        filteredRecords = supportRecords.slice();
                        console.log(`âœ… GitHub CSVì—ì„œ ${supportRecords.length}ê°œì˜ ê¸°ë¡ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
                        
                        saveRecordsToLocalStorage(); 
                        
                    } else {
                        throw new Error('CSV íŒŒì¼ì— ìœ íš¨í•œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.');
                    }
                })
                .catch(error => {
                    console.error("âŒ GitHub CSV íŒŒì¼ ë¡œë“œ ë° íŒŒì‹± ì‹¤íŒ¨:", error);
                    generateSampleData();
                })
                .finally(() => {
                    updateFilterOptions();
                    applyFilters();
                    updateRecordsList();
                });
        }
        
        // **[ìƒˆë¡œ ì¶”ê°€/ìˆ˜ì •]** DOMContentLoaded ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        document.addEventListener('DOMContentLoaded', function() {
            // 1. ë¡œê·¸ì¸ ìƒíƒœ ë³µì› ì‹œë„
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    // UI ìƒíƒœë§Œ ì—…ë°ì´íŠ¸ (setLoginStateëŠ” showPage í˜¸ì¶œ í¬í•¨)
                    document.getElementById('loginPage').classList.add('hidden');
                    document.getElementById('mainApp').classList.remove('hidden');
                    document.getElementById('userWelcome').textContent = `${user.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
                    currentUser = user; // ì „ì—­ ë³€ìˆ˜ ì„¤ì •
                    // í˜ì´ì§€ ë³µì›ì€ ë°ì´í„° ë¡œë“œ í›„ ì§„í–‰ (ì•„ë˜ finally ë¸”ë¡ì—ì„œ)
                } catch(e) {
                    console.error("ì €ì¥ëœ ì‚¬ìš©ì ì •ë³´ ë³µì› ì‹¤íŒ¨:", e);
                    localStorage.removeItem('currentUser');
                }
            }

            // 2. ë°ì´í„° ë¡œë“œ ìš°ì„ ìˆœìœ„: LocalStorage > GitHub CSV URL > Sample Data
            const loadedFromLocal = loadRecordsFromLocalStorage(); 
            
            if (!loadedFromLocal) {
                loadRecordsFromGitHub(); 
            } else {
                updateFilterOptions();
                applyFilters();
                updateRecordsList();
            }

            // 3. í˜ì´ì§€ê°€ ë¡œë“œë˜ê³  ë°ì´í„°ê°€ ì¤€ë¹„ë˜ë©´, ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ìµœì¢… UI ì¡°ì •
            if (currentUser) {
                // ë¡œê·¸ì¸ ìƒíƒœì¸ ê²½ìš°, ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
                document.querySelector('.nav-links .nav-link').classList.add('active');
                document.getElementById('dashboardPage').classList.remove('hidden');
                document.getElementById('loginPage').classList.add('hidden');
            } else {
                 // ë¡œê·¸ì•„ì›ƒ ìƒíƒœì¸ ê²½ìš°, ë¡œê·¸ì¸ í˜ì´ì§€ í‘œì‹œ
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginPage').classList.remove('hidden');
            }

            // ì—”í„°í‚¤ ë¡œê·¸ì¸
            ['username', 'password'].forEach(id => {
                document.getElementById(id).addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
            });

            // ì‹¤ì‹œê°„ ì‹œê°„ ê³„ì‚°
            ['startDate', 'startTime', 'endDate', 'endTime'].forEach(id => {
                document.getElementById(id).addEventListener('change', updateCalculatedHours);
            });

            // ê²€ìƒ‰ ì‹¤ì‹œê°„ ì ìš©
            document.getElementById('searchKeyword').addEventListener('input', function() {
                clearTimeout(this.searchTimeout);
                this.searchTimeout = setTimeout(() => applyFilters(), 300);
            });
        });

        // ìƒ˜í”Œ ë°ì´í„° ìƒì„± (ìƒëµëœ ë¶€ë¶„ì€ ìœ„ì™€ ë™ì¼)
        function generateSampleData() {
            const sampleRecords = [
                { id: 1, siteName: 'Arctera', engineerName: 'ì„ëª…ì—´', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-07', startTime: '09:30', endDate: '2025-01-07', endTime: '17:30', totalHours: '8.0', createdAt: '2025-01-07T09:30:00.000Z' },
                { id: 2, siteName: 'ëŒ€ë¦¼ê·¸ë£¹', engineerName: 'ì„ëª…ì—´', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-06', startTime: '09:30', endDate: '2025-01-06', endTime: '14:30', totalHours: '5.0', createdAt: '2025-01-06T09:30:00.000Z' },
                { id: 3, siteName: 'ì¸ì¬INC', engineerName: 'ì„ëª…ì—´', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-09', startTime: '10:00', endDate: '2025-01-10', endTime: '12:00', totalHours: '26.0', createdAt: '2025-01-09T09:30:00.000Z' },
                { id: 4, siteName: 'ì¼€ì´ë±…í¬', engineerName: 'ì„ëª…ì—´', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-06', startTime: '12:00', endDate: '2025-01-07', endTime: '12:00', totalHours: '24.0', createdAt: '2025-01-06T07:30:00.000Z' },
                { id: 5, siteName: 'ëŒ€ë¦¼ê·¸ë£¹', engineerName: 'ì†ìš©ë½', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-07', startTime: '10:00', endDate: '2025-01-07', endTime: '13:30', totalHours: '3.5', createdAt: '2025-01-06T09:30:00.000Z' },
                { id: 6, siteName: 'KBêµ­ë¯¼ì€í–‰', engineerName: 'ì—„ì •í˜„', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-07', startTime: '10:00', endDate: '2025-01-07', endTime: '17:30', totalHours: '7.5', createdAt: '2025-01-06T09:30:00.000Z' },
                { id: 7, siteName: 'ëŒ€ë¦¼ê·¸ë£¹', engineerName: 'ì´ê²½ì§„', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-06', startTime: '15:30', endDate: '2025-01-06', endTime: '16:30', totalHours: '1.0', createdAt: '2025-01-05T15:02:00.000Z' },
                { id: 8, siteName: 'KT êµ­ì œì „í™”íŠ¸ë˜í”½ë¶„ì„ì‹œìŠ¤í…œ', engineerName: 'ì—„ì •í˜„', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-06', startTime: '14:00', endDate: '2025-01-06', endTime: '16:30', totalHours: '2.5', createdAt: '2025-01-05T13:32:00.000Z' },
                { id: 9, siteName: 'ì„œìš¸ì‹ ìš©ë³´ì¦ì¬ë‹¨', engineerName: 'ì†ìš©ë½', supportType: 'ì •ê¸°ì ê²€', startDate: '2025-01-07', startTime: '14:00', endDate: '2025-01-07', endTime: '15:00', totalHours: '1.0', createdAt: '2025-01-06T13:32:00.000Z' },
                { id: 10, siteName: 'KT Bizì†”ë£¨ì…˜í”Œë«í¼ìš´ìš©íŒ€', engineerName: 'ì—„ì •í˜„', supportType: 'ì •ê¸°ì ê²€', startDate: '2025-01-08', startTime: '10:00', endDate: '2025-01-08', endTime: '11:00', totalHours: '1.0', createdAt: '2025-01-07T09:30:00.000Z' },
                { id: 11, siteName: 'GTX-A ë¯¼ìêµ¬ê°„', engineerName: 'ì†ìš©ë½', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-09', startTime: '09:00', endDate: '2025-01-09', endTime: '14:00', totalHours: '5.0', createdAt: '2025-01-08T08:30:00.000Z' },
                { id: 12, siteName: 'ë¡¯ë°ì¹´ë“œ', engineerName: 'ê¹€ì¤€ê·œ', supportType: 'ì¥ì• ì§€ì›', startDate: '2025-01-10', startTime: '14:30', endDate: '2025-01-10', endTime: '17:30', totalHours: '3.0', createdAt: '2025-01-14T13:32:00.000Z' },
                { id: 13, siteName: 'KT Tving', engineerName: 'ì—„ì •í˜„', supportType: 'ì •ê¸°ì ê²€', startDate: '2025-01-09', startTime: '14:00', endDate: '2025-01-09', endTime: '15:30', totalHours: '1.5', createdAt: '2025-01-08T13:32:00.000Z' },
                { id: 14, siteName: 'KT CLOUD IPC', engineerName: 'ì—„ì •í˜„', supportType: 'ì •ê¸°ì ê²€', startDate: '2025-01-08', startTime: '14:00', endDate: '2025-01-08', endTime: '17:30', totalHours: '3.5', createdAt: '2025-01-07T13:32:00.000Z' },
                { id: 15, siteName: 'Arctera', engineerName: 'ë¯¸ì •', supportType: 'ê¸°ìˆ ì§€ì›', startDate: '2025-01-20', startTime: '14:00', endDate: '2025-01-20', endTime: '23:30', totalHours: '9.5', createdAt: '2025-01-19T13:32:00.000Z' }
            ];
            
            supportRecords = sampleRecords;
            filteredRecords = supportRecords.slice();
            
            saveRecordsToLocalStorage(); // ìƒ˜í”Œ ë°ì´í„°ë„ ë¡œì»¬ì— ì €ì¥
        }
    </script>
</body>
</html>
